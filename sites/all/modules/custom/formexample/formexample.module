<?php
//$Id$

/**
 * @file Play with the Form API
 */

/**
 * Implimentation of hook_menu.
 */
function formexample_menu(){
  $items['formexample'] = array(
                                'title'=> 'View the form',
                                'page callback' =>'formexample_page',
                                'access arguments' => array('access content')
                                );
  return $items;
}
/**
 * Menu Callback
 * Called when user goes to http://sandbox.local/?q=formexample
 */
function formexample_page(){
 $output = t('this contains our example form');
 
 // Return the HTML generated by the $form data structure.
 $output .= drupal_get_form('formexample_nameform');
 return $output;
}

/**
 * Define a form.
 */
function formexample_nameform(){
  
  /**
   * Define Fieldsets
   */
  
  $form['personal_information'] = array(
                        '#title' => t('Personal Information'),
                        '#type' => 'fieldset',
                        '#description' => t('Information about yourself'),
                        '#collapsible' => TRUE,
                        '#collapsed' => FALSE
                        );
  $form['personal_information']['address'] = array(
                        '#title' => t('Shipping Address'),
                        '#type' => 'fieldset',
                        '#description' => t('This information is used to send you mailings and other stuff that you likely do not want.'),
                        '#collapsible' => TRUE,
                        '#collapsed' => FALSE
                        );
  
  /**
   * Fields
   */
  
  //Username
  $form['personal_information']['user_name'] = array(
                                                      '#title'=> t('Your name'),
                                                      '#type'=> 'textfield',
                                                      '#description' => t('Please enter your name.'),
                                                      '#attributes' => array('class' =>'banana')
                                                      );
  
  //Street
  $form['personal_information']['address']['street'] = array(
                                                             '#title'=> t('Street'),
                                                             '#type'=> 'textfield',
                                                             '#description' => t('Please enter your street address.')
                                                             );
  
  //State
  $form['personal_information']['address']['state'] = array(
                                                            '#title'=> t('State'),
                                                            '#type'=> 'select',
                                                            '#description' => t('Please enter your State.'),
                                                            '#options' => array(t('Virginia'),t('Washington'),t('California'))
                                                            );
  
  //Zip
  $form['personal_information']['address']['zip'] = array(
                                                             '#title'=> t('Zipcode'),
                                                             '#type'=> 'textfield',
                                                             '#description' => t('Please enter your zipcode.')
                                                             );
  
  //Submit  
  $form['submit'] = array(
                          '#type'=>'submit',
                          '#value'=>t('Submit')
                          );
  return $form;
}

/**
 * Validate the form
 */
function formexample_nameform_validate($form, &$form_state){
  if($form_state['values']['user_name'] == "King Kong"){
    drupal_set_message(t('King Kong is not allowed to use this form'));
  }
}

/**
 * Handle post-validation form submission
 */
function formexample_nameform_submit($form, &$form_state){
  $name = $form_state['values']['user_name'];
  drupal_set_message(t('Thanks for filling out the form, %name',array(
                                                                      '%name'=> $name
                                                                      )
                       )
                    );
}